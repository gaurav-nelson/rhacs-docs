<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Integrating with CI systems :: RHACS Docs</title>
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">RHACS Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="rhacs" data-version="3.64">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Red Hat Advance Cluster Security for Kubernetes</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Welcome</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Release notes</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../release_notes/364-release-notes.html">Relase notes for RHACS 3.64</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../release_notes/363-release-notes.html">Release notes for RHACS 3.63</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../release_notes/3062-release-notes.html">Release notes for RHACS 3.0.62</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../release_notes/3061-release-notes.html">Release notes for RHACS 3.0.61</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../release_notes/3060-release-notes.html">Release notes for RHACS 3.0.60</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../release_notes/3059-release-notes.html">Release notes for RHACS 3.0.59</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../release_notes/3058-release-notes.html">Release notes for RHACS 3.0.58</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../architecture/index.html">Product architecture</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Installing</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installing/prerequisites.html">Installation prerequisites</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installing/install-ocp-operator.html">Installing by using an Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Installing by using Helm charts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installing/installing_helm/install-helm-quick.html">Installing quickly</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installing/installing_helm/install-helm-customization.html">Installing with customizations</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installing/install-quick-roxctl.html">Installing quickly by using the roxctl CLI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installing/uninstall-acs.html">Uninstalling RHACS</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Configuring</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/add-custom-certificates.html">Adding custom certificates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/add-trusted-ca.html">Adding trusted certificate authorities</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/reissue-internal-certificates.html">Reissuing internal certificates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/add-security-notices.html">Adding security notices</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/enable-offline-mode.html">Enabling offline mode</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/enable-alert-data-retention.html">Enabling alert data retention</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/expose-portal-over-http.html">Exposing the RHACS portal over HTTP</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/configure-automatic-upgrades.html">Configuring automatic upgrades for secured clusters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/configure-proxy.html">Configuring a proxy for external network access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/generate-diagnostic-bundle.html">Generating a diagnostic bundle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/configure-endpoints.html">Configuring endpoints</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/monitor-acs.html">Monitoring with Prometheus</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/configure-audit-logging.html">Enabling audit logging</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Operating</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operating/view-dashboard.html">Viewing the dashboard</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operating/manage-compliance.html">Managing compliance</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operating/evaluate-security-risks.html">Evaluating security risks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operating/use-admission-controller-enforcement.html">Using admission controller enforcement</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operating/manage-security-policies.html">Managing security policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operating/manage-network-policies.html">Managing network policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operating/review-cluster-configuration.html">Reviewing cluster configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operating/examine-images-for-vulnerabilities.html">Examining images for vulnabilities</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operating/manage-vulnerabilities.html">Managing vulnerabilities</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operating/respond-to-violations.html">Responding to violations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operating/search-filter.html">Searching and filtering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Managing user access</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../operating/manage-user-access/configure-okta-identity-cloud.html">Configuring Okta Identity Cloud as a SAML 2.0 identity provider</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../operating/manage-user-access/configure-google-workspace-identity.html">Configuring Google Workspace as an OIDC identity provider</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../operating/manage-user-access/manage-role-based-access-control-3630.html">Managing RBAC in Red Hat Advanced Cluster Security for Kubernetes 3.63 and newer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../operating/manage-user-access/manage-role-based-access-control-3062.html">Managing RBAC in Red Hat Advanced Cluster Security for Kubernetes 3.0.62 and older</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../operating/manage-user-access/enable-pki-authentication.html">Enabling PKI authentication</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operating/use-system-health-dashboard.html">Using the system health dashboard</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Backup and restore</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../backup_and_restore/backing-up-acs.html">Backing up Red Hat Advanced Cluster Security for Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../backup_and_restore/restore-acs.html">Restoring from a backup</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Upgrading</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrading/upgrade-helm.html">Upgrading using Helm charts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Upgrading using the roxctl CLI</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#upgrading_roxctl/upgrade-from-44">Upgrading from Red Hat Advanced Cluster Security for Kubernetes 3.0.44 or higher</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../cli/getting-started-cli.html">Getting started with the roxctl CLI</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Support</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../support/getting-support.html">Getting support for Red Hat Advanced Cluster Security for Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../support/getting-support-stackrox.html">Getting support for the StackRox Kubernetes Security Platform</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Red Hat Advance Cluster Security for Kubernetes</span>
    <span class="version">3.64</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Red Hat Advance Cluster Security for Kubernetes</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">3.64</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Red Hat Advance Cluster Security for Kubernetes</a></li>
    <li><a href="integrate-with-ci-systems.html">Integrating with CI systems</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/gaurav-nelson/rhacs-docs/edit/main/docs/modules/integration/pages/integrate-with-ci-systems.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Integrating with CI systems</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph _abstract">
<p>Red Hat Advance Cluster Security for Kuberenetes (RHACS) integrates with a variety of continuous integration (CI) products and allows you to apply build-time and deploy-time security rules before you deploy images.</p>
</div>
<div class="paragraph">
<p>Red Hat Advance Cluster Security for Kuberenetes integrates into CI pipelines after images are built and pushed to a registry.
Pushing the image first allows developers to continue testing their artifacts while dealing with any policy violations alongside any other CI test failures, linter violations, or other problems.</p>
</div>
<div class="paragraph">
<p>If possible, you should configure the version control system to block pull or merge requests from being merged if the build stage, which includes Red Hat Advance Cluster Security for Kuberenetes checks, fails.</p>
</div>
<div class="paragraph">
<p>The integration with your CI product functions by contacting your Red Hat Advance Cluster Security for Kuberenetes installation to check whether the image complies with build-phase policies you have configured.
If there are policy violations, a detailed message is displayed on the console log, including the policy description, rationale, and remediation instructions.
Each policy includes an optional enforcement setting;
if you mark a policy for build-phase enforcement, failure of that policy causes the client to exit with a nonzero error code.</p>
</div>
<div class="paragraph">
<p>To integrate Red Hat Advance Cluster Security for Kuberenetes with your CI system, follow these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#configure-build-policies">Configure build policies</a>.</p>
</li>
<li>
<p><a href="#configure-registry-integration">Configure a registry integration</a>.</p>
</li>
<li>
<p><a href="#configure-access">Configure access</a> to your Red Hat Advance Cluster Security for Kuberenetes instance.</p>
</li>
<li>
<p><a href="#integrate-with-your-ci-pipeline">Integrate with your CI pipeline</a>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configure-build-policies"><a class="anchor" href="#configure-build-policies"></a>Configuring build policies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To check Red Hat Advance Cluster Security for Kuberenetes policies during builds, you must first configure policies that apply to the build phase of the container lifecycle. And then you must integrate with the registry that images are pushed to during the build.</p>
</div>
<div class="sect2">
<h3 id="integrate-ci-check-existing-build-phase-policies_integrate-with-ci-systems"><a class="anchor" href="#integrate-ci-check-existing-build-phase-policies_integrate-with-ci-systems"></a>Checking existing build-phase policies</h3>
<div class="paragraph">
<p>Use the RHACS portal to check any existing build-phase policies that you have configured in Red Hat Advance Cluster Security for Kuberenetes.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On the RHACS portal, navigate to <strong>Platform Configuration</strong> &#8594; <strong>System Policies</strong>.</p>
</li>
<li>
<p>Use global search to search for <code>Lifecycle Stage:Build</code>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="create-new-system-policy_integrate-with-ci-systems"><a class="anchor" href="#create-new-system-policy_integrate-with-ci-systems"></a>Creating a new system policy</h3>
<div class="paragraph">
<p>In addition to using the default policies, you can also create custom policies in Red Hat Advance Cluster Security for Kuberenetes.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On the RHACS portal, navigate to <strong>Platform Configuration</strong> &#8594; <strong>System Policies</strong>.</p>
</li>
<li>
<p>Click <strong>+ New Policy</strong>.</p>
</li>
<li>
<p>Enter the <strong>Name</strong> for the policy.</p>
</li>
<li>
<p>Select a <strong>Severity</strong> level for the policy: Critical, High, Medium, or Low.</p>
</li>
<li>
<p>Choose the <strong>Lifecycle Stages</strong> for which the policy is applicable, from <strong>Build</strong>, <strong>Deploy</strong>, or <strong>Runtime</strong>. You can select more than one stage.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you create a new policy for integrating with a CI system, select <strong>Build</strong> as the lifecycle stage.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Build-time policies apply to image fields such as CVEs and Dockerfile instructions.</p>
</li>
<li>
<p>Deploy-time policies can include all build-time policy criteria. They can also have data from your cluster configurations, such as running in privileged mode or mounting the Docker daemon socket.</p>
</li>
<li>
<p>Runtime policies can include all build-time and deploy-time policy criteria, as well as data about process executions during runtime.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Enter information about the policy in the <strong>Description</strong>, <strong>Rationale</strong>, and <strong>Remediation</strong> fields.
When CI validates the build, the data from these fields is displayed.
Therefore, include all information explaining the policy.</p>
</li>
<li>
<p>Select a category from the <strong>Categories</strong> drop-down menu.</p>
</li>
<li>
<p>Select a notifier from the <strong>Notifications</strong> drop-down menu that receives alert notifications when a violation occurs for this policy.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You must integrate Red Hat Advance Cluster Security for Kuberenetes with your notification providers, such as webhooks, Jira, or PagerDuty, to receive alert notifications. Notifiers only show up if you have integrated any notification providers with Red Hat Advance Cluster Security for Kuberenetes.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Use <strong>Restrict to Scope</strong> to enable this policy only for a specific cluster, namespace, or label.
You can add multiple scopes and also use regular expressions in RE2 Syntax for namespaces and labels.</p>
</li>
<li>
<p>Use <strong>Exclude by Scope</strong> to exclude deployments, clusters, namespaces, and labels.
This field indicates that the policy will not apply to the entities that you specify.
You can add multiple scopes and also use regular expressions in RE2 Syntax for namespaces and labels.
However, you cannot use regular expressions for selecting deployments.</p>
</li>
<li>
<p>For <strong>Excluded Images (Build Lifecycle only)</strong>, select all the images from the list for which you do not want to trigger a violation for the policy.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <strong>Excluded Images (Build Lifecycle only)</strong> setting only applies when you check images in a continuous integration system (the Build lifecycle stage).
It does not have any effect if you use this policy to check running deployments (the Deploy lifecycle stage) or runtime activities (the Runtime lifecycle stage).</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>In the <strong>Policy Criteria</strong> section, configure the attributes that will trigger the policy.</p>
</li>
<li>
<p>Select <strong>Next</strong> on the panel header.</p>
</li>
<li>
<p>The new policy panel shows a preview of the violations that are triggered if you enable the policy.</p>
</li>
<li>
<p>Select <strong>Next</strong> on the panel header.</p>
</li>
<li>
<p>Choose the enforcement behavior for the policy.
Enforcement settings are only available for the stages that you selected for the <strong>Lifecycle Stages</strong> option.
Select <strong>ON</strong> to enforce policy and report a violation. Select <strong>OFF</strong> to only report a violation.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The enforcement behavior is different for each lifecycle stage.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For the <strong>Build</strong> stage, Red Hat Advance Cluster Security for Kuberenetes fails your CI builds when images match the conditions of the policy.</p>
</li>
<li>
<p>For the <strong>Deploy</strong> stage, Red Hat Advance Cluster Security for Kuberenetes blocks the creation of deployments that match the conditions of the policy. In clusters with admission controller enforcement, the Kubernetes or OpenShift Container Platform API server blocks all noncompliant deployments. In other clusters, Red Hat Advance Cluster Security for Kuberenetes edits noncompliant deployments to prevent pods from being scheduled.</p>
</li>
<li>
<p>For the <strong>Runtime</strong> stage, Red Hat Advance Cluster Security for Kuberenetes stops all pods that match the conditions of the policy.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Policy enforcement can impact running applications or development processes. Before you enable enforcement options, inform all stakeholders and plan how to respond to the automated enforcement actions.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configure-registry-integration"><a class="anchor" href="#configure-registry-integration"></a>Configuring registry integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To scan images, you must provide Red Hat Advance Cluster Security for Kuberenetes with access to the image registry you are using in your build pipeline.</p>
</div>
<div class="sect2">
<h3 id="check-for-existing-registry-integration_integrate-with-ci-systems"><a class="anchor" href="#check-for-existing-registry-integration_integrate-with-ci-systems"></a>Checking for existing registry integration</h3>
<div class="paragraph">
<p>You can use the RHACS portal to check if you have already integrated with a registry.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On the RHACS portal, navigate to <strong>Platform Configuration</strong> &#8594; <strong>Integrations</strong>.</p>
</li>
<li>
<p>Under the <strong>Image Integration</strong> section, look for highlighted <strong>Registry</strong> tiles.
The tiles also list the number of items already configured for that tile.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If none of the Registry tiles are highlighted, you must first integrate with an image registry.</p>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="integrate-with-image-registries.html#integrating-with-image-registries" class="page">Integrating with image registries</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configure-access"><a class="anchor" href="#configure-access"></a>Configuring access</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Red Hat Advance Cluster Security for Kuberenetes provides a command-line interface (CLI) <code>roxctl</code> to make it easy to integrate Red Hat Advance Cluster Security for Kuberenetes policies into your build pipeline.
The <code>roxctl</code> CLI prints detailed information about problems and how to fix them so that developers can maintain high standards in the early phases of the container lifecycle.</p>
</div>
<div class="paragraph">
<p>To securely authenticate to the Red Hat Advance Cluster Security for Kuberenetes API server, you must create an API token.</p>
</div>
<div class="sect2">
<h3 id="cli-authentication_integrate-with-ci-systems"><a class="anchor" href="#cli-authentication_integrate-with-ci-systems"></a>Authenticating using the roxctl CLI</h3>
<div class="paragraph">
<p>For authentication, you can use an authentication token or your administrator password.
Red Hat recommends using an authentication token in a production environment because each token is assigned specific access control permissions.</p>
</div>
<div class="paragraph">
<p>Use the following steps to generate an authentication token.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the RHACS portal.</p>
</li>
<li>
<p>Go to <strong>Platform Configuration</strong> &#8594; <strong>Integrations</strong>.</p>
</li>
<li>
<p>Scroll down to the <strong>Authentication Tokens</strong> category, and click <strong>API Token</strong>.</p>
</li>
<li>
<p>Click <strong>Generate Token</strong>.</p>
</li>
<li>
<p>Enter a name for the token and select a role that provides the required level of access (for example, <strong>Continuous Integration</strong> or <strong>Sensor Creator</strong>).</p>
</li>
<li>
<p>Click <strong>Generate</strong>.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Copy the generated token and securely store it.
You will not be able to view it again.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>After you have generated the authentication token, export it as <code>ROX_API_TOKEN</code> variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-terminal hljs" data-lang="terminal">$ export ROX_API_TOKEN=&lt;api_token&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also save the token in a file and use it with the <code>--token-file</code> option.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-terminal hljs" data-lang="terminal">$ roxctl central debug dump --token-file &lt;token_file&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>You cannot use both the <code>-password</code> (<code>-p</code>) and the <code>--token-file</code> options simultaneously.</p>
</li>
<li>
<p>If you have already set <code>ROX_API_TOKEN</code> variable, and specify the <code>--token-file</code> option, the <code>roxctl</code> CLI uses the specified token file for authentication.</p>
</li>
<li>
<p>If you have already set <code>ROX_API_TOKEN</code> variable, and specify the <code>--password</code> option, the <code>roxctl</code> CLI uses the specified password for authentication.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="install-roxctl-cli-binary"><a class="anchor" href="#install-roxctl-cli-binary"></a>Installing the roxctl CLI by downloading the binary</h3>
<div class="paragraph">
<p>You can install the <code>roxctl</code> CLI to interact with Red Hat Advance Cluster Security for Kuberenetes from a
command-line interface. You can install <code>roxctl</code> on Linux, Windows, or macOS.</p>
</div>
<div class="sect3">
<h4 id="installing-cli-on-linux_integrate-with-ci-systems"><a class="anchor" href="#installing-cli-on-linux_integrate-with-ci-systems"></a>Installing the roxctl CLI on Linux</h4>
<div class="paragraph">
<p>You can install the <code>roxctl</code> CLI binary on Linux by using the following procedure.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Download the latest version of the <code>roxctl</code> CLI:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-terminal hljs" data-lang="terminal">$ curl -O https://mirror.openshift.com/pub/rhacs/assets/3.64.1/bin/Linux/roxctl</code></pre>
</div>
</div>
</li>
<li>
<p>Make the <code>roxctl</code> binary executable:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-terminal hljs" data-lang="terminal">$ chmod +x roxctl</code></pre>
</div>
</div>
</li>
<li>
<p>Place the <code>roxctl</code> binary in a directory that is on your <code>PATH</code>:</p>
<div class="paragraph">
<p>To check your <code>PATH</code>, execute the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-terminal hljs" data-lang="terminal">$ echo $PATH</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Verification</div>
<ul>
<li>
<p>Verify the roxctl version you have installed:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-terminal hljs" data-lang="terminal">$ roxctl version</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="installing-cli-on-macos_integrate-with-ci-systems"><a class="anchor" href="#installing-cli-on-macos_integrate-with-ci-systems"></a>Installing the roxctl CLI on macOS</h4>
<div class="paragraph">
<p>You can install the <code>roxctl</code> CLI binary on macOS by using the following procedure.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Download the latest version of the <code>roxctl</code> CLI:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-terminal hljs" data-lang="terminal">$ curl -O https://mirror.openshift.com/pub/rhacs/assets/3.64.1/bin/Darwin/roxctl</code></pre>
</div>
</div>
</li>
<li>
<p>Remove all extended attributes from the binary:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-terminal hljs" data-lang="terminal">$ xattr -c roxctl</code></pre>
</div>
</div>
</li>
<li>
<p>Make the <code>roxctl</code> binary executable:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-terminal hljs" data-lang="terminal">$ chmod +x roxctl</code></pre>
</div>
</div>
</li>
<li>
<p>Place the <code>roxctl</code> binary in a directory that is on your <code>PATH</code>:</p>
<div class="paragraph">
<p>To check your <code>PATH</code>, execute the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-terminal hljs" data-lang="terminal">$ echo $PATH</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Verification</div>
<ul>
<li>
<p>Verify the roxctl version you have installed:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-terminal hljs" data-lang="terminal">$ roxctl version</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="installing-cli-on-windows_integrate-with-ci-systems"><a class="anchor" href="#installing-cli-on-windows_integrate-with-ci-systems"></a>Installing the roxctl CLI on Windows</h4>
<div class="paragraph">
<p>You can install the <code>roxctl</code> CLI binary on Windows by using the following procedure.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Download the latest version of the <code>roxctl</code> CLI:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-terminal hljs" data-lang="terminal">$ curl -O https://mirror.openshift.com/pub/rhacs/assets/3.64.1/bin/Windows/roxctl.exe</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Verification</div>
<ul>
<li>
<p>Verify the roxctl version you have installed:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-terminal hljs" data-lang="terminal">$ roxctl version</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="run-roxctl-from-container_integrate-with-ci-systems"><a class="anchor" href="#run-roxctl-from-container_integrate-with-ci-systems"></a>Running the roxctl CLI from a container</h3>
<div class="paragraph">
<p>The <code>roxctl</code> client is the default entry point in Red Hat Advance Cluster Security for Kuberenetes <code>roxctl</code> image.
To run the <code>roxctl</code> client in a container image:</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log in to the <code>registry.redhat.io</code> registry.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-terminal hljs" data-lang="terminal">$ docker login registry.redhat.io</code></pre>
</div>
</div>
</li>
<li>
<p>Pull the latest container image for the <code>roxctl</code> CLI.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-terminal hljs" data-lang="terminal">$ docker pull registry.redhat.io/rh-acs/roxctl:3.64.1</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>After you install the CLI, you can run it by using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-terminal hljs" data-lang="terminal">$ docker run -e ROX_API_TOKEN=$ROX_API_TOKEN \
  -it registry.redhat.io/rh-acs/roxctl:3.64.1 \
  -e $ROX_CENTRAL_ADDRESS &lt;command&gt;</code></pre>
</div>
</div>
<div class="ulist">
<div class="title">Verification</div>
<ul>
<li>
<p>Verify the roxctl version you have installed.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-terminal hljs" data-lang="terminal">$ docker run -it registry.redhat.io/rh-acs/roxctl:3.64.1 version</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="integrate-with-your-ci-pipeline"><a class="anchor" href="#integrate-with-your-ci-pipeline"></a>Integrating with your CI pipeline</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After you have finished these procedures, the next step is to integrate with your CI pipeline.</p>
</div>
<div class="paragraph">
<p>Each CI system might require a slightly different configuration.</p>
</div>
<div class="sect2">
<h3 id="using-jenkins"><a class="anchor" href="#using-jenkins"></a>Using Jenkins</h3>
<div class="paragraph">
<p>Use the <a href="https://plugins.jenkins.io/stackrox-container-image-scanner">StackRox Container Image Scanner</a> Jenkins plugin for integrating with Jenkins.
You can use this plugin in both Jenkins freestyle projects and pipelines.</p>
</div>
</div>
<div class="sect2">
<h3 id="integrate-circle-ci_integrate-with-ci-systems"><a class="anchor" href="#integrate-circle-ci_integrate-with-ci-systems"></a>Using CircleCI</h3>
<div class="paragraph">
<p>You can integrate Red Hat Advance Cluster Security for Kuberenetes with CircleCI.</p>
</div>
<div class="ulist">
<div class="title">Prerequisetes</div>
<ul>
<li>
<p>You have a token with <code>read</code> and <code>write</code> permissions for the <code>Image</code> resource.</p>
</li>
<li>
<p>You have a username and password for your Docker Hub account.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log in to CircleCI and open an existing project or create a new project.</p>
</li>
<li>
<p>Click <strong>Project Settings</strong>.</p>
</li>
<li>
<p>Click <strong>Environment variables</strong>.</p>
</li>
<li>
<p>Click <strong>Add variable</strong> and create the following three environment variables:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: <strong>STACKROX_CENTRAL_HOST</strong> - The DNS name or IP address of Central.</p>
</li>
<li>
<p><strong>Name</strong>: <strong>ROX_API_TOKEN</strong> - The API token to access Red Hat Advance Cluster Security for Kuberenetes.</p>
</li>
<li>
<p><strong>Name</strong>: <strong>DOCKERHUB_PASSWORD</strong> - The password for your Docker Hub account.</p>
</li>
<li>
<p><strong>Name</strong>: <strong>DOCKERHUB_USER</strong> - The username for your Docker Hub account.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Create a directory called <code>.circleci</code> in the root directory of your local code repository for your selected project, if you do not already have a CircleCI configuration file.</p>
</li>
<li>
<p>Create a <code>config.yml</code> configuration file with the following lines in the <code>.circleci</code> directory:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-yml hljs" data-lang="yml">version: 2
jobs:
  check-policy-compliance:
    docker:
      - image: 'circleci/node:latest'
        auth:
          username: $DOCKERHUB_USER
          password: $DOCKERHUB_PASSWORD
    steps:
      - checkout
      - run:
          name: Install roxctl
          command: |
              curl -H "Authorization: Bearer $ROX_API_TOKEN" https://$STACKROX_CENTRAL_HOST:443/api/cli/download/roxctl-linux -o roxctl &amp;&amp; chmod +x ./roxctl
      - run:
          name: Scan images for policy deviations and vulnerabilities
          command: |
              ./roxctl image check --endpoint "$STACKROX_CENTRAL_HOST:443" --image "&lt;your_registry/repo/image_name&gt;" <i class="conum" data-value="1"></i><b>(1)</b>
      - run:
          name: Scan deployment files for policy deviations
          command: |
              ./roxctl image check --endpoint "$STACKROX_CENTRAL_HOST:443" --image "&lt;your_deployment_file&gt;" <i class="conum" data-value="2"></i><b>(2)</b>
              # Important note: This step assumes the YAML file you'd like to test is located in the project.
workflows:
  version: 2
  build_and_test:
    jobs:
      - check-policy-compliance</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Replace <code>&lt;your_registry/repo/image_name&gt;</code> with your registry and image path.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Replace <code>&lt;your_deployment_file&gt;</code> with the path to your deployment file.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you already have a <code>config.yml</code> file for CircleCI in your repository, add a new jobs section with the specified details in your existing configuration file.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>After you commit the configuration file to your repository, navigate to the <strong>Jobs</strong> queue in your CircleCI dashboard to verify the build policy enforcement.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
